---
import NavLink from './NavLink.astro';
import ThemeToggle from './ThemeToggle.astro';
import siteConfig from '../data/site-config';

const navLinks = siteConfig.headerNavLinks || [];
---

<header class="fixed top-0 inset-x-0 z-40 bg-[#0a0a14]/80 backdrop-blur-lg border-b border-purple-500/20">
    <nav class="relative max-w-7xl mx-auto px-4 lg:px-8">
        <div class="flex items-center justify-between h-16">
            <!-- Logo -->
            <div class="flex items-center">
                {
                    siteConfig.logo && siteConfig.logo?.src ? (
                        <a href="/" class="flex items-center">
                            <img src={siteConfig.logo.src} alt={siteConfig.logo.alt || ''} class="h-10" />
                        </a>
                    ) : (
                        <a href="/" class="flex items-center gap-2">
                            <div class="text-2xl font-bold">
                                <span class="text-white">{'{ } '}</span>
                                <span class="gradient-text">STACK.DEV</span>
                            </div>
                        </a>
                    )
                }
            </div>

            <!-- Desktop Navigation -->
            <ul class="hidden lg:flex items-center gap-8">
                {navLinks.map((link) => (
                    <li>
                        <NavLink 
                            class="text-base text-white hover:text-cyan-400 transition-colors font-medium neon-hover" 
                            href={link.href}
                        >
                            {link.text}
                        </NavLink>
                    </li>
                ))}
            </ul>

            <!-- Right side: Theme toggle + Contact button -->
            <div class="hidden lg:flex items-center gap-4">
                <a 
                    href="/contact" 
                    class="inline-flex items-center px-6 py-2 rounded-full btn-gradient font-semibold text-white neon-hover"
                >
                    Contact
                </a>
            </div>

            <!-- Mobile menu button -->
            <div class="lg:hidden flex items-center gap-2">
                <button
                    id="menu-toggle"
                    class="p-2 text-white hover:text-cyan-400 transition-colors"
                    aria-label="Toggle menu"
                    aria-expanded="false"
                >
                    <svg class="w-6 h-6 menu-open" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path 
                            stroke-linecap="round" 
                            stroke-linejoin="round" 
                            stroke-width="2" 
                            d="M4 6h16M4 12h16M4 18h16"
                        />
                    </svg>
                    <svg class="w-6 h-6 menu-close hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path 
                            stroke-linecap="round" 
                            stroke-linejoin="round" 
                            stroke-width="2" 
                            d="M6 18L18 6M6 6l12 12"
                        />
                    </svg>
                </button>
            </div>
        </div>

        <!-- Mobile Navigation -->
        <div 
            id="mobile-menu"
            class="hidden lg:hidden border-t border-purple-500/20 py-4"
        >
            <ul class="flex flex-col gap-4">
                {navLinks.map((link) => (
                    <li>
                        <NavLink 
                            class="text-base text-white hover:text-cyan-400 transition-colors block py-2" 
                            href={link.href}
                        >
                            {link.text}
                        </NavLink>
                    </li>
                ))}
                <li class="pt-2">
                    <a 
                        href="/contact" 
                        class="inline-flex items-center px-6 py-2 rounded-full btn-gradient font-semibold text-white w-full justify-center"
                    >
                        Contact
                    </a>
                </li>
            </ul>
        </div>
    </nav>
</header>

<script>
    function initMobileMenu() {
        const button = document.getElementById('menu-toggle');
        const menu = document.getElementById('mobile-menu');
        const menuOpen = button?.querySelector('.menu-open');
        const menuClose = button?.querySelector('.menu-close');
        
        button?.addEventListener('click', () => {
            const isOpen = !menu?.classList.contains('hidden');
            
            if (isOpen) {
                menu?.classList.add('hidden');
                menuOpen?.classList.remove('hidden');
                menuClose?.classList.add('hidden');
                button.setAttribute('aria-expanded', 'false');
            } else {
                menu?.classList.remove('hidden');
                menuOpen?.classList.add('hidden');
                menuClose?.classList.remove('hidden');
                button.setAttribute('aria-expanded', 'true');
            }
        });
    }

    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initMobileMenu);
    } else {
        initMobileMenu();
    }

    document.addEventListener('astro:page-load', initMobileMenu);
</script>

